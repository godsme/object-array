cmake_minimum_required(VERSION 3.19)
project(object_array)

#set(CMAKE_CXX_COMPILER "g++-10")

set(CMAKE_CXX_STANDARD 20)

include_directories(
        "${CMAKE_CURRENT_SOURCE_DIR}/include"
        "${CMAKE_CURRENT_SOURCE_DIR}/third-party"
)

if (CMAKE_CXX_COMPILER_ID MATCHES "Clang")
  set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wdeprecated -frelaxed-template-template-args")
endif()

set(OBJ_ARRAY_SRC
        include/l0-infra/array/concept/SimpleFind.h
        include/l0-infra/array/concept/Pred.h
        include/l0-infra/array/mixin/find/NonScopedSimpleFind.h
        include/l0-infra/array/concept/RangedArrayLike.h
        include/l0-infra/array/mixin/find/SimpleFindExt.h
        include/l0-infra/base/InvokeConstMethod.h
        include/l0-infra/array/mixin/array_like/RangedArrayLike.h
        include/l0-infra/array/holder/ScatteredArrayDataHolder.h
        include/l0-infra/base/Placement.h
        include/l0-infra/base/detail/StorageTrait.h
        include/l0-infra/base/DeduceSizeType.h
        include/l0-infra/base/DeduceOffsetType.h
        include/l0-infra/array/holder/detail/DeduceElemType.h
        include/l0-infra/array/holder/ArrayDataHolder.h
        include/l0-infra/array/holder/ObjectArrayDataHolder.h
        include/l0-infra/base/IntBitSet.h
        include/l0-infra/base/detail/DeduceBitSetIntType.h
        include/l0-infra/base/BitSet.h
        include/l0-infra/array/holder/detail/ObjectTrait.h
        include/l0-infra/array/concept/ArrayLike.h
        include/l0-infra/array/mixin/array_like/RangedArray.h
        include/l0-infra/array/mixin/detail/Mixins.h
        include/l0-infra/array/mixin/array_like/ContinuousArrayLike.h
        include/l0-infra/array/concept/ContiguousArrayLikeDataHolder.h
        include/l0-infra/array/concept/SimpleArrayLike.h
        include/l0-infra/array/mixin/find/ScopedSimpleFind.h
        include/l0-infra/array/concept/ScopedArrayLike.h
        include/l0-infra/array/mixin/find/ScopedFind.h
        include/l0-infra/array/ScatteredArray.h
        include/l0-infra/array/ObjectArray.h
        include/l0-infra/array/holder/ArrayViewDataHolder.h
        include/l0-infra/array/holder/detail/ViewElemTrait.h
        include/l0-infra/array/ArrayView.h
        include/l0-infra/array/holder/detail/ArrayDataHolderInterface.h
        include/l0-infra/array/holder/RangedViewDataHolder.h
        include/l0-infra/array/view/Slice.h
        include/l0-infra/array/concept/IndexedContainer.h
        include/l0-infra/array/view/ScopedView.h
        include/l0-infra/array/mixin/array_like/IndexedContainer.h
        include/l0-infra/array/mixin/factory/RangedViewFactory.h
        include/l0-infra/array/detail/ArrayOffset.h
        include/l0-infra/array/holder/ScopedViewDataHolder.h
        include/l0-infra/array/mixin/factory/ScopedViewFactory.h
        include/l0-infra/array/view/WithIndexView.h
        include/l0-infra/array/holder/ProxyRangedViewDataHolder.h
        include/l0-infra/array/holder/detail/RangedViewDataHolderInterface.h
        include/l0-infra/array/detail/CrtpHelper.h
        include/l0-infra/array/holder/detail/ArrayLikeViewDataHolder.h
        include/l0-infra/array/mixin/factory/WithIndexViewFactory.h
        include/l0-infra/array/mixin/iterable/IterableWithIndexArrayLike.h
        include/l0-infra/array/iterator/Iterator.h
        include/l0-infra/array/iterator/WithIndexIterator.h
        include/l0-infra/array/mixin/iterable/IterableArrayLike.h
        include/l0-infra/array/view/IndexedScopedView.h
        include/l0-infra/array/mixin/iterable/IterableWithIndexScopedArrayLike.h
        include/l0-infra/array/iterator/WithIndexScopedIterator.h
        include/l0-infra/array/iterator/detail/WithIndexIterator.h
        include/l0-infra/array/iterator/detail/ScopedIterator.h
        include/l0-infra/array/iterator/EmptyIterator.h
        include/l0-infra/array/view/detail/IndexedArrayView.h
        include/l0-infra/array/mixin/factory/WithIndexScopedViewFactory.h
        include/l0-infra/array/iterator/detail/SimpleIterator.h
        include/l0-infra/array/iterator/ScopedIterator.h
        include/l0-infra/array/mixin/iterable/IterableScopedArrayLike.h
        include/l0-infra/array/mixin/factory/RValueWithIndexViewFactory.h
        include/l0-infra/array/mixin/factory/RValueRangedViewFactory.h
        include/l0-infra/array/mixin/factory/RvalueScopedViewFactory.h
        include/l0-infra/base/IntOpt.h
        include/l0-infra/base/detail/DeduceIntOptional.h
        include/l0-infra/array/holder/detail/ContinuousArrayDataHolderInterface.h
        include/l0-infra/array/mixin/accessor/IndexedRefAccessor.h
        include/l0-infra/array/mixin/accessor/ByIndexAccessor.h
        include/l0-infra/array/mixin/find/ScopedFindExt.h
        include/l0-infra/array/concept/detail/PredTypeTrait.h
        include/l0-infra/array/mixin/accessor/ScopedByIndexAccessor.h
        include/l0-infra/array/mixin/count/RangedElemsCount.h
        include/l0-infra/array/mixin/count/ScopedElemCount.h
        include/l0-infra/array/mixin/count/FullScopedElemCount.h
        include/l0-infra/array/mixin/count/RangedScopedElemCount.h
        include/l0-infra/array/detail/ArrayScope.h
        include/l0-infra/array/holder/detail/ArrayHolderTrait.h
        include/l0-infra/array/mixin/foreach/SimpleForEach.h
        include/l0-infra/array/mixin/array_like/ArrayElemVisit.h
        include/l0-infra/array/concept/Op.h
        include/l0-infra/array/mixin/detail/ForEachCodeBlock.h
        include/l0-infra/array/concept/ElemVisitor.h
        include/l0-infra/array/concept/detail/OpTypeTrait.h
        include/l0-infra/array/mixin/foreach/SimpleForEachExt.h
        include/l0-infra/array/mixin/foreach/ScopedForEach.h
        include/l0-infra/array/mixin/foreach/ScopedForEachExt.h
        include/l0-infra/array/mixin/append/SimpleAppend.h
        include/l0-infra/array/mixin/erase/RangedClear.h
        include/l0-infra/array/mixin/erase/ScopedCleanUp.h
        include/l0-infra/array/mixin/erase/EraseExt.h
        include/l0-infra/array/concept/SimpleMutable.h
        include/l0-infra/array/mixin/minmax/SimpleMinElem.h
        include/l0-infra/array/concept/Less.h
        include/l0-infra/array/mixin/minmax/SimpleMinElemExt.h
        include/l0-infra/array/mixin/detail/DefaultLessThan.h
        include/l0-infra/array/mixin/minmax/ScopedMinElem.h
        include/l0-infra/array/mixin/minmax/ScopedMinElemExt.h
        include/l0-infra/base/StructWrapper.h
        include/l0-infra/array/holder/ConstArrayViewDataHolder.h
        include/l0-infra/array/mixin/foreach/ScopedSimpleForEach.h
        include/l0-infra/array/mixin/minmax/ScopedSimpleMinElem.h
        include/l0-infra/array/concept/SimpleMinElem.h
        include/l0-infra/array/concept/detail/LessTypeTrait.h
        include/l0-infra/array/detail/config.h
        include/l0-infra/array/detail/ConceptDef.h
        include/l0-infra/array/mixin/sort/ArraySort.h
        include/l0-infra/base/SizeOfArray.h
        include/l0-infra/array/holder/ArrayIndicesDataHolder.h
        include/l0-infra/array/detail/ArrayIndices.h
        include/l0-infra/array/holder/SortViewDataHolder.h
        include/l0-infra/array/view/SortView.h
        include/l0-infra/array/mixin/sort/ArraySortExt.h
        include/l0-infra/array/mixin/factory/SortViewFactory.h
        include/l0-infra/array/mixin/factory/RValueSortViewFactory.h
        include/l0-infra/array/mixin/factory/ScopedSortViewFactory.h
        include/l0-infra/array/mixin/detail/ValueRangedArray.h
        include/l0-infra/array/iterator/IndicesRandomIterator.h
        include/l0-infra/array/mixin/iterable/IterableArrayIndices.h
        include/l0-infra/array/mixin/sort/ScopedSort.h
        include/l0-infra/array/detail/ScopedArrayIndices.h
        include/l0-infra/array/holder/OrderedViewDataHolder.h
        include/l0-infra/array/view/OrderedView.h
        include/l0-infra/array/view/OrderedScopedView.h
        include/l0-infra/array/mixin/sort/RValueArraySort.h
        include/l0-infra/array/mixin/sort/RValueScopedSort.h
        include/l0-infra/array/mixin/array_like/ScopedRangedArray.h
        include/l0-infra/array/holder/ProxyScopedViewDataHolder.h
        include/l0-infra/array/holder/detail/ScopedViewDataHolderInterface.h
        include/l0-infra/array/mixin/detail/ValueScopedRangedArray.h
        include/l0-infra/array/holder/FromViewDataHolder.h
        include/l0-infra/array/holder/detail/RangedViewDataHolderBase.h
        include/l0-infra/array/holder/UntilViewDataHolder.h
        test/ut/base/PlacementTest.cpp
        test/ut/base/DeduceSizeType.cpp
        test/ut/base/IntBitSetTest.cpp
        test/ut/base/BitSetTest.cpp
        test/ut/array/ViewElemTraitTest.cpp
        test/ut/array/ArrayIndicesTest.cpp
        test/ut/array/IndicesRandomIteratorTest.cpp
        test/ut/array/ArraySortObjectTest.cpp
        test/ut/base/IntOptionalTest.cpp
        test/ut/array/ObjectArrayDataHolderTest.cpp
        test/ut/array/ScatteredArrayDataHolderTest.cpp
        test/ut/array/ObjectArrayTest.cpp
        test/ut/array/ScopedSimpleFindTest.cpp
        test/ut/array/SliceTest.cpp
        test/ut/array/ArrayViewTest.cpp
        test/ut/array/ScatteredArrayTest.cpp
        test/ut/array/UnscopedSimpleFindTest.cpp
        include/l0-infra/array/mixin/detail/___public_mixin_delimiter___.h
        include/l0-infra/array/mixin/detail/___mutable_mixin_delimiter___.h
        include/l0-infra/array/mixin/count/ArrayEquality.h
        include/l0-infra/array/mixin/sort/IndicesBasedSort.h
        include/l0-infra/array/mixin/replace/RangedReplace.h
        include/l0-infra/array/mixin/array_like/ViewedArray.h
        include/l0-infra/array/mixin/array_like/ObjectIndex.h
        include/l0-infra/array/mixin/replace/ReplaceExt.h
        include/l0-infra/array/mixin/append/AppendExt.h
        include/l0-infra/array/mixin/append/ViewAppend.h
        include/l0-infra/array/mixin/replace/ScopedReplace.h include/l0-infra/array/holder/detail/ViewDataHolder.h include/l0-infra/array/mixin/append/OrderedAppend.h include/l0-infra/array/OrderedObjectArray.h test/ut/array/OrderedObjectArrayTest.cpp include/l0-infra/array/holder/OrderedArrayDataHolder.h include/l0-infra/array/holder/IndexedOrderedArrayDataHolder.h include/l0-infra/array/mixin/append/OrderedDoAppend.h include/l0-infra/array/holder/OrderedArrayIndicesDataHolder.h include/l0-infra/array/detail/OrderedArrayIndices.h include/l0-infra/array/IndexedOrderedArray.h include/l0-infra/array/mixin/append/IndexedOrderedAppend.h test/ut/array/IndexedOrderedArrayTest.cpp include/l0-infra/array/mixin/erase/SimpleDoErase.h include/l0-infra/array/mixin/erase/SimpleErase.h include/l0-infra/array/mixin/erase/IndexedOrderedDoErase.h include/l0-infra/array/mixin/erase/ContiguousDoErase.h include/l0-infra/array/mixin/erase/SimpleRangedClear.h include/l0-infra/array/mixin/erase/ScatteredClear.h include/l0-infra/array/mixin/replace/SimpleReplace.h include/l0-infra/array/mixin/replace/OrderedDoReplace.h include/l0-infra/array/mixin/replace/SimpleDoReplace.h include/l0-infra/array/mixin/replace/OrderedReplace.h include/l0-infra/array/mixin/replace/IndexedOrderedDoReplace.h include/l0-infra/array/mixin/append/SimpleDoAppend.h include/l0-infra/array/mixin/detail/___ranged_array_tag___.h include/l0-infra/array/OrderedArray.h test/ut/array/OrderedArrayTest.cpp
        include/l0-infra/array/iterator/WithIndexIterator.h include/l0-infra/array/iterator/IndexBasedIterator.h include/l0-infra/array/mixin/iterable/IterableIndexBasedArray.h include/l0-infra/array/holder/DynamicArrayDataHolder.h include/l0-infra/array/DynamicArray.h test/ut/array/DynamicArrayTest.cpp include/l0-infra/array/mixin/array_like/IndexedObjectIndex.h include/l0-infra/array/mixin/array_like/DynamicObjectIndex.h include/l0-infra/array/mixin/erase/RangedClearExt.h include/l0-infra/array/mixin/sort/DynamicArraySort.h include/l0-infra/array/concept/DynamicAllocator.h include/l0-infra/array/detail/DynamicArrayMixins.h include/l0-infra/array/DynamicArrayView.h test/ut/array/DynamicArrayViewTest.cpp)

add_executable(object_array_test test/ut/catch.cpp ${OBJ_ARRAY_SRC})
add_executable(object_array_it
        test/it/main.cpp
        test/it/ObjectArrayTest-it.cpp
        test/it/SliceTest-it.cpp)
